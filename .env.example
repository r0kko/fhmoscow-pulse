# Copy this file to `.env` and replace values as needed.
# Mandatory settings
DB_HOST=localhost
DB_PORT=5432
DB_NAME=fhpulse
DB_USER=postgres
DB_PASS=secret

# connection to legacy MySQL database
LEGACY_DB_HOST=legacy-host
LEGACY_DB_PORT=3306
LEGACY_DB_NAME=legacydb
LEGACY_DB_USER=root
LEGACY_DB_PASS=secret

# optional: connection to an additional external MariaDB/MySQL database
# NOTE: Use a DB user with read-only privileges. The application enforces
# read-only for this connection and will block any write attempts.
# EXT_DB_HOST=external-host
# EXT_DB_PORT=3306
# EXT_DB_NAME=externaldb
# EXT_DB_USER=external_user
# EXT_DB_PASS=secret
# EXT_DB_SSL=false
# EXT_DB_SSL_REJECT_UNAUTHORIZED=true
# Optional tuning for external DB pool and keepalive
# EXT_DB_POOL_MAX=10
# EXT_DB_POOL_MIN=1
# EXT_DB_POOL_ACQUIRE_MS=60000
# EXT_DB_POOL_IDLE_MS=300000
# EXT_DB_POOL_EVICT_MS=60000
# EXT_DB_KEEPALIVE_DELAY_MS=10000
# EXT_DB_CONNECT_TIMEOUT_MS=10000
# EXT_DB_RETRY_MAX=3

JWT_SECRET=your_jwt_secret
SESSION_SECRET=supersecret

# Optional overrides
# Remove the leading '#' to enable and adjust the values.
# IMPORTANT: Quote values containing spaces, #, ;, &, or $ to avoid parsing issues.
# Example: DB_PASS='p@ssw#rd;with=specials & more'
# token for DaData suggestions in the Vue client
# VITE_DADATA_TOKEN=your_dadata_api_token
# server-side DaData token
# DADATA_TOKEN=your_dadata_api_token
# secret key for passport validation
# DADATA_SECRET=your_dadata_secret
# JWT_ACCESS_TTL=30m
# JWT_REFRESH_TTL=60d
# JWT_ALG=HS256
# PASSWORD_MIN_LENGTH=8
# PASSWORD_MAX_LENGTH=128
# PASSWORD_PATTERN="(?=.*[A-Za-z])(?=.*\\d)"
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=user@example.com
# SMTP_PASS=secret
# EMAIL_FROM=no-reply@example.com
# REGISTRATION_RATE_WINDOW_MS=3600000
# REGISTRATION_RATE_MAX=30
# PASSWORD_RESET_RATE_WINDOW_MS=3600000
# PASSWORD_RESET_RATE_MAX=30
# LOGIN_RATE_WINDOW_MS=60000
# LOGIN_RATE_MAX=30
# RATE_LIMIT_WINDOW_MS=60000
# RATE_LIMIT_MAX=1200
# Use Redis to share rate limits across app instances (recommended for prod)
# RATE_LIMIT_USE_REDIS=true
# S3_BUCKET=my-bucket
# S3_REGION=ru-1
# S3_ENDPOINT=https://s3.example.ru
# S3_ACCESS_KEY=your_key
# S3_SECRET_KEY=your_secret
#
# Production deployment settings
# Public base URL (used to infer HTTPS for secure cookies)
# BASE_URL=https://lk.fhmoscow.com
#
# If SPA and API share a common parent domain, prefer setting COOKIE_DOMAIN to that parent
# (e.g., fhmoscow.com) to allow cookies on subdomains. If unsure or using CDNs with different
# hostnames, leave COOKIE_DOMAIN unset to use safer host-only cookies.
# COOKIE_DOMAIN=
#
# Allowlist SPA origins for CORS when requests are cross-origin (CDN/custom domains)
# Multiple origins separated by commas.
# ALLOWED_ORIGINS=https://lk.fhmoscow.com,https://pulse.fhmoscow.com
# COOKIE_PARTITIONED=true
# Optional: refresh cookie lifetime in ms (default ~60 days)
# REFRESH_COOKIE_MAX_AGE_MS=5184000000
# In production behind HTTPS, SameSite=None is used by default when BASE_URL is https.
# You can override if needed.
# REFRESH_COOKIE_SAME_SITE=none
# CSRF_COOKIE_NAME=XSRF-TOKEN-API
# CSRF_EXEMPT_LOGIN=false
# CSRF_HMAC_SECRET=strong_random_string
# Secret for signed verification URLs in document QR codes
# If unset, will fall back to CSRF_HMAC_SECRET/JWT_SECRET/SESSION_SECRET
# VERIFY_HMAC_SECRET=strong_random_string
# CSRF_HMAC_TTL_SECONDS=21600
# VITE_API_BASE=/api
# SSL_CERT_PATH=/etc/ssl/pulse/fullchain.pem
# SSL_KEY_PATH=/etc/ssl/pulse/privkey.pem
# Uncomment the SSL_* variables only if you want the Node.js server to handle TLS.

# Cron schedules are fixed in code; no env overrides are used for sync jobs.
# Prometheus metrics are exposed at /metrics.

# Match agreement reminders
# Default schedule: daily at 09:00 Europe/Moscow
# Behavior: reminders are sent as a single daily digest at 09:00 MSK.
# Sections: (1) назначить время и площадку — для матчей с < 7 дней и без предложений;
# (2) принять решение — по заявкам, ожидающим ответа более суток (одноразовое напоминание).
# MATCH_REMINDER_CRON=0 9 * * *
# Days horizon to check upcoming matches for reminders (does not affect aggregation rules)
# MATCH_REMINDER_HORIZON_DAYS=14

# Container images for production compose file
# APP_IMAGE=ghcr.io/your-organization/fhmoscow-pulse
# CLIENT_IMAGE=ghcr.io/your-organization/fhmoscow-pulse-client

# Directory with SBSansText fonts for PDF export
PDF_FONT_DIR=./assets/fonts

# PDF export tuning (QR stamp & footer barcode)
# Optional: adjust e-signature stamp and QR sizing if needed
# PDF_STAMP_WIDTH=270
# PDF_STAMP_HEIGHT=66
# Minimum width (px) to allow auto-shrinking of the stamp border
# PDF_STAMP_MIN_WIDTH=220
# PDF_STAMP_PAD_X=10
# PDF_STAMP_PAD_Y=8
# PDF_STAMP_GAP=10
# Minimum QR side (px) to keep codes scannable (should not go below ~32)
# PDF_QR_MIN_SIZE=40
# Target proportion of QR side relative to the smaller inner stamp side [0.25..0.6]
# PDF_QR_IDEAL_RATIO=0.46
# Quiet zone in modules (added on each side of QR)
# PDF_QR_QUIET_MODULES=4
# Footer barcode appearance (PDF417)
# PDF_BARCODE_WIDTH=110
# PDF_BARCODE_OPACITY=0.7

# Short-link settings for compact QR codes
# Enable short links (recommended for very compact QR):
# SHORTLINK_ENABLED=true
# Storage backend: 'db' (default) or 'memory' (tests/dev fallback)
# SHORTLINK_BACKEND=db
# Short-link code length (6..24)
# SHORTLINK_CODE_LENGTH=10
# Expiration in days
# SHORTLINK_TTL_DAYS=365
# Public prefix where the resolver is exposed (under BASE_URL). In most deployments the API lives under /api
# SHORTLINK_PUBLIC_PREFIX=/api/v

# Login security (temporary lockout)
# NOTE: thresholds are hardcoded in codebase for consistency across envs.
# The variables below are ignored.
# LOGIN_MAX_ATTEMPTS=
# LOGIN_ATTEMPT_WINDOW_MS=
# LOGIN_LOCKOUT_MS=

# Observability
# Grafana admin credentials for local stack (infra/observability)
# GRAFANA_ADMIN_USER=admin
# GRAFANA_ADMIN_PASSWORD=change-me
# Grafana annotations API (for npm run obs:annotate)
# GRAFANA_URL=http://localhost:3001
# GRAFANA_TOKEN=<api-key>
# Alertmanager integrations (example)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/XXX/YYY/ZZZ
# Protect Prometheus metrics endpoint with basic auth (recommended outside internal networks)
# METRICS_USER=metrics
# METRICS_PASS=change-me
# Force secure cookies behind TLS-terminating proxy (overrides NODE_ENV)
# FORCE_SECURE_COOKIES=true
# OpenTelemetry tracing (Tempo)
# OTEL_ENABLED=true
# OTEL_SERVICE_NAME=api
# OTEL_EXPORTER_OTLP_ENDPOINT=http://tempo:4317
