## Include this file into your nginx site config (e.g., /etc/nginx/conf.d/pulse.conf)
## using:  include /etc/nginx/conf.d/security.conf;  (adjust path accordingly)

# Block direct access to Prometheus metrics from the Internet
location /metrics {
  deny all;
}

# Recommended secure headers
add_header X-Content-Type-Options nosniff;
add_header X-Frame-Options DENY;
add_header Referrer-Policy no-referrer-when-downgrade;
add_header X-XSS-Protection "1; mode=block";
# HSTS (enable only if all traffic is HTTPS and subdomains covered)
# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

# Optionally restrict Swagger UI in production (uncomment to enable)
# location /api-docs {
#   allow 127.0.0.1;  # or your office IP/CIDR
#   deny all;
# }
